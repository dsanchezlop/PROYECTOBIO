{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, reactive } from 'vue';\nimport * as d3 from \"d3\";\nimport axios from 'axios';\nconst selectedFertilizer = ref('nitrogen');\nexport default {\n  data() {\n    return {\n      selectedStates: ref([]),\n      currentZoom: 1\n      // name: \"charts\"\n    };\n  },\n\n  mounted() {\n    const svg = d3.select(this.$refs.chart).append(\"svg\").attr('width', '75%').attr('height', '100%').style(\"position\", \"fixed\").style('left', '25%').style('top', '20%');\n\n    // Aquí es donde se carga el archivo world.svg y se agrega al SVG\n    d3.xml(require(\"@/assets/world.svg\")).then(data => {\n      // Llama a la función después de cargar y agregar el mapa SVG\n      this.getDataFromAPI();\n      const importedNode = document.importNode(data.documentElement, true);\n      svg.node().appendChild(importedNode);\n\n      // Obtener todos los elementos \"path\" del SVG\n      const paths = svg.selectAll('path');\n\n      // Asignar las funciones \"changeColorOnClick\", \"changeColorOnHover\" y \"restoreColorOnHover\" a los eventos correspondientes de cada elemento \"path\"\n      paths.on('click', this.changeColorOnClick).on('mouseover', this.changeColorOnHover).on('mouseout', this.restoreColorOnHover);\n\n      // Agregar zoom al mapa\n      const zoom = d3.zoom().scaleExtent([1, 8]) // Definir los límites de zoom\n      .on('zoom', this.zoomed); // Llamar a la función zoomed() cada vez que se haga zoom\n\n      svg.call(zoom); // Llamar a la función zoom en el elemento SVG\n\n      // Inicializar el estado del zoom\n      this.currentZoom = 1;\n    }).catch(error => {\n      console.error(error);\n    });\n    const countries = this.$route.query.countries;\n    if (countries) {\n      const countryList = countries.split(\",\");\n      const selectedCountries = countryList.join(\", \");\n    }\n\n    // Añadir el controlador de eventos al control deslizante\n    const yearSlider = document.getElementById('year-slider');\n    yearSlider.addEventListener('input', event => {\n      this.updateMap(event.target.value);\n    });\n  },\n  methods: {\n    // Función para cambiar el color de fondo de un elemento \"path\" a verde al hacer clic en él\n    changeColorOnClick(event) {\n      const path = event.currentTarget;\n      const color = this.selectedPath === path ? this.colors[0] : this.colors[1];\n      path.style.fill = color;\n      this.selectedPath = path;\n    },\n    // Función para cambiar el color de fondo de un elemento \"path\" a púrpura al pasar el mouse por encima\n    changeColorOnHover(event) {\n      const path = event.target;\n      if (!path.classList.contains('selectedPath')) {\n        // path.style.fill = 'purple';\n        path.style.fill = 'blue';\n        document.getElementById(\"hover-value2\").textContent = path.getAttribute('title');\n      }\n    },\n    // Función para restaurar el color de fondo de un elemento \"path\" al dejar de pasar el mouse por encima\n    restoreColorOnHover(event) {\n      const path = event.target;\n      if (!path.classList.contains('selectedPath')) {\n        // path.style.fill = 'black';\n        this.colors();\n      }\n    },\n    // Funcion para vaciar la array y quitar el color de los paises seleccionados\n    clearSelection() {\n      // Vaciar el array de países seleccionados\n      this.selectedStates.splice(0);\n\n      // Deseleccionar todos los elementos del DOM que tengan la clase \"selectedPath\"\n      const selectedPaths = document.querySelectorAll(\".selectedPath\");\n      selectedPaths.forEach(element => {\n        element.classList.remove(\"selectedPath\");\n        // element.style.fill = \"black\";\n        this.colors();\n      });\n    },\n    // Función para hacer zoom\n    zoomIn() {\n      this.currentZoom = Math.min(this.currentZoom / 0.9, 1.5); // Incrementar el factor de zoom actual y asegurarse de que no exceda el límite máximo\n      d3.select('svg') // Seleccionar el elemento SVG\n      .transition() // Agregar transición animada al zoom\n      .duration(500) // Duración de la transición\n      .attr(\"transform\", \"scale(\" + this.currentZoom + \")\"); // Aplicar la transformación de zoom\n    },\n\n    // Función para hacer zoom out\n    zoomOut() {\n      this.currentZoom = Math.max(this.currentZoom * 0.9, 0.5); // Decrementar el factor de zoom actual y asegurarse de que no sea menor que el límite mínimo\n      d3.select('svg') // Seleccionar el elemento SVG\n      .transition() // Agregar una transición suave al zoom\n      .duration(500) // Duración de la transición (en milisegundos)\n      .attr(\"transform\", \"scale(\" + this.currentZoom + \")\"); // Aplicar la transformación de zoom\n    },\n\n    // Función para hacer zoom con el scroll del ratón y draggear el mapa\n    zoomed(event) {\n      this.currentZoom = event.transform.k;\n      d3.select(\"svg\").attr(\"transform\", event.transform); // Aplicar la transformación al elemento SVG actual\n    },\n\n    navigateToCharts() {\n      const selectedCountries = this.selectedStates.map(state => state.title).join(\",\");\n      this.$router.push({\n        name: \"charts\",\n        query: {\n          countries: selectedCountries\n        }\n      });\n    },\n    getDataFromAPI() {\n      const apiUrl = `http://49.12.36.190/api/fertilizers-${selectedFertilizer.value}`;\n      axios.get(apiUrl).then(response => {\n        const data = response.data;\n        this.updateMapValues(data);\n      }).catch(error => {\n        console.error(error);\n      });\n    },\n    updateMapValues(data) {\n      const paths = document.querySelectorAll('path');\n      const tooltip = document.createElement('div'); // Crea el elemento div para el tooltip\n      tooltip.style.position = 'absolute';\n      tooltip.style.backgroundColor = 'white';\n      tooltip.style.border = '1px solid gray';\n      tooltip.style.padding = '5px';\n      tooltip.style.pointerEvents = 'none';\n      tooltip.style.display = 'none'; // Oculta el tooltip por defecto\n      document.body.appendChild(tooltip); // Agrega el tooltip al body\n\n      paths.forEach(path => {\n        const code = path.getAttribute('id');\n        const value = data.find(item => item.code === code)?.amount ?? 0;\n        path.setAttribute('amount', value);\n        path.addEventListener('mouseover', () => {\n          // Obtener posición del mouse y actualizar el contenido y la posición del tooltip\n          const x = event.clientX;\n          const y = event.clientY;\n          tooltip.style.top = `${y}px`;\n          tooltip.style.left = `${x}px`;\n          tooltip.style.display = 'block'; // Muestra el tooltip\n          tooltip.textContent = `${path.getAttribute('title')}: ${value}`;\n        });\n        path.addEventListener('mousemove', () => {\n          // Actualiza la posición del tooltip mientras el mouse se mueve dentro del elemento \"path\"\n          const x = event.clientX;\n          const y = event.clientY;\n          tooltip.style.top = `${y}px`;\n          tooltip.style.left = `${x}px`;\n        });\n        path.addEventListener('mouseout', () => {\n          // Oculta el tooltip cuando el mouse sale del elemento \"path\"\n          tooltip.style.display = 'none';\n        });\n      });\n      this.updateMapColors();\n    },\n    createLegend(colorScale, colors) {\n      // Elimina la leyenda anterior si existe\n      const existingLegend = document.getElementById('legend-container');\n      if (existingLegend) {\n        existingLegend.remove();\n      }\n      const legendContainer = document.createElement('div');\n      legendContainer.setAttribute('id', 'legend-container');\n      legendContainer.style.display = 'flex';\n      legendContainer.style.flexDirection = 'row';\n      legendContainer.style.alignItems = 'center';\n      legendContainer.style.justifyContent = 'center';\n      legendContainer.style.marginTop = '10px';\n      colors.forEach((color, index) => {\n        const colorBox = document.createElement('div');\n        colorBox.style.backgroundColor = color;\n        colorBox.style.width = '20px';\n        colorBox.style.height = '20px';\n        colorBox.style.margin = '0 5px';\n        const rangeText = document.createElement('span');\n        rangeText.style.marginLeft = '5px';\n        rangeText.style.marginRight = '10px';\n        const range = colorScale.invertExtent(color);\n        // Caso especial para el primer rango (0.00 - 0.00)\n        if (index === 0) {\n          rangeText.textContent = `${range[0].toFixed(2)} - ${range[0].toFixed(2)}`;\n        } else {\n          rangeText.textContent = `${range[0].toFixed(2)} - ${range[1].toFixed(2)}`;\n        }\n        const legendItem = document.createElement('div');\n        legendItem.style.display = 'flex';\n        legendItem.style.alignItems = 'center';\n        legendItem.appendChild(colorBox);\n        legendItem.appendChild(rangeText);\n        legendContainer.appendChild(legendItem);\n      });\n\n      // Agrega la leyenda al final del body\n      document.body.appendChild(legendContainer);\n    },\n    updateMapColors() {\n      const paths = document.querySelectorAll('path');\n      const colors = ['#F5E1F7', '#E6B8E6', '#D7A3D3', '#C68FC6', '#B67AB6', '#A666A3', '#965291', '#854D80', '#73386E', '#62245C'];\n      const amounts = Array.from(paths, path => Number(path.getAttribute('amount')));\n      const maxAmount = Math.max(...amounts);\n      const colorScale = d3.scaleQuantile().domain(amounts.filter(amount => amount > 0)) // Excluye el valor 0.00 de la escala\n      .range(colors.slice(1)); // Excluye el primer color del rango, ya que se manejará por separado\n\n      paths.forEach(path => {\n        const amount = Number(path.getAttribute('amount'));\n        const color = amount === 0 ? colors[0] : colorScale(amount); // Usa el primer color del arreglo para el rango 0.00 - 0.00\n        path.style.fill = color;\n      });\n\n      // Crear leyenda\n      this.createLegend(colorScale, colors);\n    },\n    updateFertilizerType(event) {\n      selectedFertilizer.value = event.target.value;\n      this.getDataFromAPI();\n    },\n    addLegend() {\n      // Elimina la leyenda anterior si existe\n      const existingLegend = document.getElementById('map-legend');\n      if (existingLegend) {\n        existingLegend.remove();\n      }\n\n      // A continuación, el código existente para agregar la leyenda\n      const legend = L.control({\n        position: 'bottomright'\n      });\n      legend.onAdd = () => {\n        const div = L.DomUtil.create('div', 'info legend');\n        div.id = 'map-legend'; // Agrega un ID para que podamos seleccionarlo y eliminarlo fácilmente\n        const grades = this.legendGrades;\n        const labels = [];\n        for (let i = 0; i < grades.length; i++) {\n          labels.push('<i style=\"background:' + this.getColor(grades[i] + 1) + '\"></i> ' + grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+'));\n        }\n        div.innerHTML = labels.join('');\n        return div;\n      };\n      legend.addTo(this.map);\n    },\n    updateMap(year) {\n      // Aquí es donde puedes actualizar el mapa con los datos correspondientes al año\n      console.log(\"Año seleccionado:\", year);\n      // Llama a las funciones necesarias para actualizar el mapa aquí\n    },\n\n    playYears() {\n      const startYear = 1961;\n      const endYear = 2019;\n      let currentYear = startYear;\n      const interval = setInterval(() => {\n        updateMap(currentYear);\n        yearSlider.value = currentYear;\n        currentYear++;\n        if (currentYear > endYear) {\n          clearInterval(interval);\n        }\n      }, 1000); // Cambia cada 1000 milisegundos (1 segundo)\n    },\n\n    colors() {\n      const paths = document.querySelectorAll('path');\n      const colors = ['#F5E1F7', '#E6B8E6', '#D7A3D3', '#C68FC6', '#B67AB6', '#A666A3', '#965291', '#854D80', '#73386E', '#62245C'];\n      const amounts = Array.from(paths, path => Number(path.getAttribute('amount')));\n      const colorScale = d3.scaleQuantile().domain(amounts.filter(amount => amount > 0)) // Excluye el valor 0.00 de la escala\n      .range(colors.slice(1)); // Excluye el primer color del rango, ya que se manejará por separado\n\n      paths.forEach(path => {\n        const amount = Number(path.getAttribute('amount'));\n        const color = amount === 0 ? colors[0] : colorScale(amount); // Usa el primer color del arreglo para el rango 0.00 - 0.00\n        path.style.fill = color;\n      });\n    }\n\n    // const playButton = document.getElementById('play-button');\n    //       playButton.addEventListener('click', playYears);\n  }\n};","map":{"version":3,"names":["ref","reactive","d3","axios","selectedFertilizer","data","selectedStates","currentZoom","mounted","svg","select","$refs","chart","append","attr","style","xml","require","then","getDataFromAPI","importedNode","document","importNode","documentElement","node","appendChild","paths","selectAll","on","changeColorOnClick","changeColorOnHover","restoreColorOnHover","zoom","scaleExtent","zoomed","call","catch","error","console","countries","$route","query","countryList","split","selectedCountries","join","yearSlider","getElementById","addEventListener","event","updateMap","target","value","methods","path","currentTarget","color","selectedPath","colors","fill","classList","contains","textContent","getAttribute","clearSelection","splice","selectedPaths","querySelectorAll","forEach","element","remove","zoomIn","Math","min","transition","duration","zoomOut","max","transform","k","navigateToCharts","map","state","title","$router","push","name","apiUrl","get","response","updateMapValues","tooltip","createElement","position","backgroundColor","border","padding","pointerEvents","display","body","code","find","item","amount","setAttribute","x","clientX","y","clientY","top","left","updateMapColors","createLegend","colorScale","existingLegend","legendContainer","flexDirection","alignItems","justifyContent","marginTop","index","colorBox","width","height","margin","rangeText","marginLeft","marginRight","range","invertExtent","toFixed","legendItem","amounts","Array","from","Number","maxAmount","scaleQuantile","domain","filter","slice","updateFertilizerType","addLegend","legend","L","control","onAdd","div","DomUtil","create","id","grades","legendGrades","labels","i","length","getColor","innerHTML","addTo","year","log","playYears","startYear","endYear","currentYear","interval","setInterval","clearInterval"],"sources":["C:\\Users\\daniv\\Documents\\GitHub\\PROYECTOBIO\\my-svg-map\\src\\components\\SVGMap.vue"],"sourcesContent":["<template>\r\n   <select @change=\"updateFertilizerType\">\r\n      <option value=\"nitrogen\">Nitrogen Derived</option>\r\n      <option value=\"phosphorous\">Phosphorous Derived</option>\r\n      <option value=\"potassium\">Potassium Derived</option>\r\n   </select>\r\n   <div style=\"display: flex; justify-content: center; margin-top: 10px;\">\r\n      <input type=\"range\" id=\"year-slider\" min=\"1961\" max=\"2019\" step=\"1\" value=\"1961\">\r\n      <button id=\"play-button\">Play</button>\r\n   </div>\r\n   <br>\r\n   <button class=\"button-zoom\" @click=\"zoomIn\">+</button>\r\n   <button class=\"button-zoom\" @click=\"zoomOut\">-</button>\r\n   <br>\r\n   <button class=\"button-container\" @click=\"clearSelection\"> Clear Selection </button>\r\n   <br>\r\n   <button v-if=\"selectedStates.length > 1\" class=\"button-container\" @click=\"navigateToCharts\">Go to charts</button>\r\n\r\n   <div class=\"prio\">\r\n      <div style=\"display:flex; text-align: center; align-items: center;\">\r\n         <h2>Hovered Country:</h2>\r\n         <h3 style=\"color: red\" id=\"hover-value2\">Move your mouse</h3>\r\n      </div>\r\n      <h2>Selected Countries:</h2>\r\n      <div style=\"display:inline\">\r\n         <!-- up to down -->\r\n         <h4 v-for=\"state in selectedStates\" :key=\"state.id\">\r\n            {{ state.id }}: {{ state.title }}\r\n         </h4>\r\n\r\n         <!-- right to left -->\r\n         <!-- <h4 style=\"display:inline; margin:10px;\" v-for=\"state in selectedStates\" :key=\"state.id\"> {{ state.id }} :\r\n           {{ state.title }} </h4> -->\r\n      </div>\r\n\r\n   </div>\r\n\r\n   <div ref=\"chart\" @click=\"changeColorOnClick($event)\" style=\"position: relative; width: 75%; height: 80%; margin-left: 25%; margin-top: 33%;\">\r\n   </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport { ref, reactive } from 'vue';\r\nimport * as d3 from \"d3\";\r\nimport axios from 'axios';\r\n\r\nconst selectedFertilizer = ref('nitrogen');\r\n\r\nexport default {\r\n   data() {\r\n      return {\r\n         selectedStates: ref([]),\r\n         currentZoom: 1,\r\n         // name: \"charts\"\r\n      }\r\n   },\r\n   mounted() {\r\n      const svg = d3.select(this.$refs.chart)\r\n         .append(\"svg\")\r\n         .attr('width', '75%')\r\n         .attr('height', '100%')\r\n         .style(\"position\", \"fixed\")\r\n         .style('left', '25%')\r\n         .style('top', '20%');\r\n\r\n      // Aquí es donde se carga el archivo world.svg y se agrega al SVG\r\n      d3.xml(require(\"@/assets/world.svg\"))\r\n         .then(data => {\r\n\r\n            // Llama a la función después de cargar y agregar el mapa SVG\r\n            this.getDataFromAPI();\r\n\r\n            const importedNode = document.importNode(data.documentElement, true);\r\n            svg.node().appendChild(importedNode);\r\n\r\n            // Obtener todos los elementos \"path\" del SVG\r\n            const paths = svg.selectAll('path');\r\n\r\n            // Asignar las funciones \"changeColorOnClick\", \"changeColorOnHover\" y \"restoreColorOnHover\" a los eventos correspondientes de cada elemento \"path\"\r\n            paths\r\n               .on('click', this.changeColorOnClick)\r\n               .on('mouseover', this.changeColorOnHover)\r\n               .on('mouseout', this.restoreColorOnHover);\r\n\r\n            // Agregar zoom al mapa\r\n            const zoom = d3.zoom()\r\n               .scaleExtent([1, 8]) // Definir los límites de zoom\r\n               .on('zoom', this.zoomed); // Llamar a la función zoomed() cada vez que se haga zoom\r\n\r\n            svg.call(zoom); // Llamar a la función zoom en el elemento SVG\r\n\r\n            // Inicializar el estado del zoom\r\n            this.currentZoom = 1;\r\n\r\n\r\n         })\r\n         .catch(error => {\r\n            console.error(error);\r\n         });\r\n      const countries = this.$route.query.countries;\r\n      if (countries) {\r\n         const countryList = countries.split(\",\");\r\n         const selectedCountries = countryList.join(\", \");\r\n      }\r\n\r\n      // Añadir el controlador de eventos al control deslizante\r\n      const yearSlider = document.getElementById('year-slider');\r\n      yearSlider.addEventListener('input', (event) => {\r\n         this.updateMap(event.target.value);\r\n      });\r\n   },\r\n   methods: {\r\n      // Función para cambiar el color de fondo de un elemento \"path\" a verde al hacer clic en él\r\n      changeColorOnClick(event) {\r\n         const path = event.currentTarget;\r\n         const color = this.selectedPath === path ? this.colors[0] : this.colors[1];\r\n         path.style.fill = color;\r\n         this.selectedPath = path;\r\n      }\r\n      ,\r\n\r\n      // Función para cambiar el color de fondo de un elemento \"path\" a púrpura al pasar el mouse por encima\r\n      changeColorOnHover(event) {\r\n         const path = event.target;\r\n         if (!path.classList.contains('selectedPath')) {\r\n            // path.style.fill = 'purple';\r\n            path.style.fill = 'blue';\r\n            document.getElementById(\"hover-value2\").textContent = path.getAttribute('title');\r\n         }\r\n      },\r\n\r\n      // Función para restaurar el color de fondo de un elemento \"path\" al dejar de pasar el mouse por encima\r\n      restoreColorOnHover(event) {\r\n         const path = event.target;\r\n\r\n         if (!path.classList.contains('selectedPath')) {\r\n            // path.style.fill = 'black';\r\n            this.colors();\r\n         }\r\n      },\r\n      // Funcion para vaciar la array y quitar el color de los paises seleccionados\r\n      clearSelection() {\r\n         // Vaciar el array de países seleccionados\r\n         this.selectedStates.splice(0);\r\n\r\n         // Deseleccionar todos los elementos del DOM que tengan la clase \"selectedPath\"\r\n         const selectedPaths = document.querySelectorAll(\".selectedPath\");\r\n         selectedPaths.forEach(element => {\r\n            element.classList.remove(\"selectedPath\");\r\n            // element.style.fill = \"black\";\r\n            this.colors();\r\n         });\r\n      },\r\n      // Función para hacer zoom\r\n      zoomIn() {\r\n         this.currentZoom = Math.min(this.currentZoom / 0.9, 1.5); // Incrementar el factor de zoom actual y asegurarse de que no exceda el límite máximo\r\n         d3.select('svg') // Seleccionar el elemento SVG\r\n            .transition() // Agregar transición animada al zoom\r\n            .duration(500) // Duración de la transición\r\n            .attr(\"transform\", \"scale(\" + this.currentZoom + \")\"); // Aplicar la transformación de zoom\r\n      },\r\n      // Función para hacer zoom out\r\n      zoomOut() {\r\n         this.currentZoom = Math.max(this.currentZoom * 0.9, 0.5); // Decrementar el factor de zoom actual y asegurarse de que no sea menor que el límite mínimo\r\n         d3.select('svg') // Seleccionar el elemento SVG\r\n            .transition() // Agregar una transición suave al zoom\r\n            .duration(500) // Duración de la transición (en milisegundos)\r\n            .attr(\"transform\", \"scale(\" + this.currentZoom + \")\"); // Aplicar la transformación de zoom\r\n\r\n      },\r\n      // Función para hacer zoom con el scroll del ratón y draggear el mapa\r\n      zoomed(event) {\r\n         this.currentZoom = event.transform.k;\r\n         d3.select(\"svg\").attr(\"transform\", event.transform); // Aplicar la transformación al elemento SVG actual\r\n      },\r\n      navigateToCharts() {\r\n         const selectedCountries = this.selectedStates.map(state => state.title).join(\",\");\r\n         this.$router.push({ name: \"charts\", query: { countries: selectedCountries } });\r\n      },\r\n      getDataFromAPI() {\r\n         const apiUrl = `http://49.12.36.190/api/fertilizers-${selectedFertilizer.value}`;\r\n\r\n         axios.get(apiUrl)\r\n            .then(response => {\r\n               const data = response.data;\r\n               this.updateMapValues(data);\r\n            })\r\n            .catch(error => {\r\n               console.error(error);\r\n            });\r\n      },\r\n\r\n      updateMapValues(data) {\r\n         const paths = document.querySelectorAll('path');\r\n         const tooltip = document.createElement('div'); // Crea el elemento div para el tooltip\r\n         tooltip.style.position = 'absolute';\r\n         tooltip.style.backgroundColor = 'white';\r\n         tooltip.style.border = '1px solid gray';\r\n         tooltip.style.padding = '5px';\r\n         tooltip.style.pointerEvents = 'none';\r\n         tooltip.style.display = 'none'; // Oculta el tooltip por defecto\r\n         document.body.appendChild(tooltip); // Agrega el tooltip al body\r\n\r\n         paths.forEach(path => {\r\n            const code = path.getAttribute('id');\r\n            const value = data.find(item => item.code === code)?.amount ?? 0;\r\n            path.setAttribute('amount', value);\r\n\r\n            path.addEventListener('mouseover', () => {\r\n               // Obtener posición del mouse y actualizar el contenido y la posición del tooltip\r\n               const x = event.clientX;\r\n               const y = event.clientY;\r\n               tooltip.style.top = `${y}px`;\r\n               tooltip.style.left = `${x}px`;\r\n               tooltip.style.display = 'block'; // Muestra el tooltip\r\n               tooltip.textContent = `${path.getAttribute('title')}: ${value}`;\r\n\r\n            });\r\n\r\n            path.addEventListener('mousemove', () => {\r\n               // Actualiza la posición del tooltip mientras el mouse se mueve dentro del elemento \"path\"\r\n               const x = event.clientX;\r\n               const y = event.clientY;\r\n               tooltip.style.top = `${y}px`;\r\n               tooltip.style.left = `${x}px`;\r\n            });\r\n\r\n            path.addEventListener('mouseout', () => {\r\n               // Oculta el tooltip cuando el mouse sale del elemento \"path\"\r\n               tooltip.style.display = 'none';\r\n            });\r\n         });\r\n         this.updateMapColors();\r\n      },\r\n      createLegend(colorScale, colors) {\r\n         // Elimina la leyenda anterior si existe\r\n         const existingLegend = document.getElementById('legend-container');\r\n         if (existingLegend) {\r\n            existingLegend.remove();\r\n         }\r\n\r\n         const legendContainer = document.createElement('div');\r\n         legendContainer.setAttribute('id', 'legend-container');\r\n         legendContainer.style.display = 'flex';\r\n         legendContainer.style.flexDirection = 'row';\r\n         legendContainer.style.alignItems = 'center';\r\n         legendContainer.style.justifyContent = 'center';\r\n         legendContainer.style.marginTop = '10px';\r\n\r\n         colors.forEach((color, index) => {\r\n            const colorBox = document.createElement('div');\r\n            colorBox.style.backgroundColor = color;\r\n            colorBox.style.width = '20px';\r\n            colorBox.style.height = '20px';\r\n            colorBox.style.margin = '0 5px';\r\n\r\n            const rangeText = document.createElement('span');\r\n            rangeText.style.marginLeft = '5px';\r\n            rangeText.style.marginRight = '10px';\r\n            const range = colorScale.invertExtent(color);\r\n            // Caso especial para el primer rango (0.00 - 0.00)\r\n            if (index === 0) {\r\n               rangeText.textContent = `${range[0].toFixed(2)} - ${range[0].toFixed(2)}`;\r\n            } else {\r\n               rangeText.textContent = `${range[0].toFixed(2)} - ${range[1].toFixed(2)}`;\r\n            }\r\n\r\n            const legendItem = document.createElement('div');\r\n            legendItem.style.display = 'flex';\r\n            legendItem.style.alignItems = 'center';\r\n            legendItem.appendChild(colorBox);\r\n            legendItem.appendChild(rangeText);\r\n\r\n            legendContainer.appendChild(legendItem);\r\n         });\r\n\r\n         // Agrega la leyenda al final del body\r\n         document.body.appendChild(legendContainer);\r\n      },\r\n      updateMapColors() {\r\n         const paths = document.querySelectorAll('path');\r\n         const colors = [\r\n            '#F5E1F7',\r\n            '#E6B8E6',\r\n            '#D7A3D3',\r\n            '#C68FC6',\r\n            '#B67AB6',\r\n            '#A666A3',\r\n            '#965291',\r\n            '#854D80',\r\n            '#73386E',\r\n            '#62245C'\r\n\r\n         ];\r\n         const amounts = Array.from(paths, path => Number(path.getAttribute('amount')));\r\n         const maxAmount = Math.max(...amounts);\r\n         const colorScale = d3.scaleQuantile()\r\n            .domain(amounts.filter(amount => amount > 0)) // Excluye el valor 0.00 de la escala\r\n            .range(colors.slice(1)); // Excluye el primer color del rango, ya que se manejará por separado\r\n\r\n         paths.forEach(path => {\r\n            const amount = Number(path.getAttribute('amount'));\r\n            const color = amount === 0 ? colors[0] : colorScale(amount); // Usa el primer color del arreglo para el rango 0.00 - 0.00\r\n            path.style.fill = color;\r\n         });\r\n\r\n         // Crear leyenda\r\n         this.createLegend(colorScale, colors);\r\n      },\r\n\r\n      updateFertilizerType(event) {\r\n         selectedFertilizer.value = event.target.value;\r\n         this.getDataFromAPI();\r\n      },\r\n\r\n      addLegend() {\r\n         // Elimina la leyenda anterior si existe\r\n         const existingLegend = document.getElementById('map-legend');\r\n         if (existingLegend) {\r\n            existingLegend.remove();\r\n         }\r\n\r\n         // A continuación, el código existente para agregar la leyenda\r\n         const legend = L.control({ position: 'bottomright' });\r\n\r\n         legend.onAdd = () => {\r\n            const div = L.DomUtil.create('div', 'info legend');\r\n            div.id = 'map-legend'; // Agrega un ID para que podamos seleccionarlo y eliminarlo fácilmente\r\n            const grades = this.legendGrades;\r\n            const labels = [];\r\n\r\n            for (let i = 0; i < grades.length; i++) {\r\n               labels.push(\r\n                  '<i style=\"background:' +\r\n                  this.getColor(grades[i] + 1) +\r\n                  '\"></i> ' +\r\n                  grades[i] +\r\n                  (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+')\r\n               );\r\n            }\r\n\r\n            div.innerHTML = labels.join('');\r\n            return div;\r\n         };\r\n\r\n         legend.addTo(this.map);\r\n      },\r\n      updateMap(year) {\r\n         // Aquí es donde puedes actualizar el mapa con los datos correspondientes al año\r\n         console.log(\"Año seleccionado:\", year);\r\n         // Llama a las funciones necesarias para actualizar el mapa aquí\r\n      },\r\n      playYears() {\r\n         const startYear = 1961;\r\n         const endYear = 2019;\r\n         let currentYear = startYear;\r\n\r\n         const interval = setInterval(() => {\r\n            updateMap(currentYear);\r\n            yearSlider.value = currentYear;\r\n            currentYear++;\r\n\r\n            if (currentYear > endYear) {\r\n               clearInterval(interval);\r\n            }\r\n         }, 1000); // Cambia cada 1000 milisegundos (1 segundo)\r\n      },\r\n      colors() {\r\n         const paths = document.querySelectorAll('path');\r\n         const colors = [\r\n            '#F5E1F7',\r\n            '#E6B8E6',\r\n            '#D7A3D3',\r\n            '#C68FC6',\r\n            '#B67AB6',\r\n            '#A666A3',\r\n            '#965291',\r\n            '#854D80',\r\n            '#73386E',\r\n            '#62245C'\r\n\r\n         ];\r\n         const amounts = Array.from(paths, path => Number(path.getAttribute('amount')));\r\n         const colorScale = d3.scaleQuantile()\r\n            .domain(amounts.filter(amount => amount > 0)) // Excluye el valor 0.00 de la escala\r\n            .range(colors.slice(1)); // Excluye el primer color del rango, ya que se manejará por separado\r\n\r\n         paths.forEach(path => {\r\n            const amount = Number(path.getAttribute('amount'));\r\n            const color = amount === 0 ? colors[0] : colorScale(amount); // Usa el primer color del arreglo para el rango 0.00 - 0.00\r\n            path.style.fill = color;\r\n         });\r\n      }\r\n\r\n      // const playButton = document.getElementById('play-button');\r\n      //       playButton.addEventListener('click', playYears);\r\n\r\n\r\n\r\n   }\r\n};\r\n\r\n\r\n</script>\r\n\r\n\r\n<style scoped>\r\nbutton {\r\n   background-color: #604caf;\r\n   color: #fff;\r\n   border: none;\r\n   border-radius: 5px;\r\n   padding: 10px;\r\n   font-size: 16px;\r\n   cursor: pointer;\r\n}\r\n\r\nbutton:hover {\r\n   background-color: #3b285f;\r\n}\r\n\r\n.prio {\r\n   position: relative;\r\n   z-index: 1;\r\n   margin-right: auto;\r\n   width: fit-content;\r\n   height: fit-content;\r\n}\r\n\r\nh2,\r\nh3,\r\nh4 {\r\n   color: red;\r\n}\r\n\r\n.selectedPath {\r\n   animation-name: slowchange;\r\n   animation-duration: 1.5s;\r\n   animation-fill-mode: forwards;\r\n   transition: fill 0.5s ease-in-out;\r\n}\r\n\r\npath:hover {\r\n   animation-name: hoverChange;\r\n   animation-duration: 1s;\r\n   animation-fill-mode: forwards;\r\n}\r\n\r\n.map-container {\r\n   width: 100vw;\r\n   display: flex;\r\n   justify-content: center;\r\n   align-items: center;\r\n}\r\n\r\n.button-container {\r\n   position: relative;\r\n   z-index: 1;\r\n   margin-right: auto;\r\n   width: fit-content;\r\n   height: fit-content;\r\n}\r\n\r\n.button-zoom {\r\n   position: relative;\r\n   z-index: 1;\r\n   margin-right: auto;\r\n   width: 2%;\r\n   height: 2%;\r\n}\r\n\r\n.draggeable {\r\n   cursor: move;\r\n}\r\n\r\n.selected {\r\n   fill: green;\r\n}\r\n\r\npath:hover {\r\n   animation-name: hoverChange;\r\n   animation-duration: 1s;\r\n   animation-fill-mode: forwards;\r\n   transition: fill 0.5s ease-in-out;\r\n}\r\n\r\n#legend-container {\r\n   position: absolute;\r\n   bottom: -50px;\r\n   left: 50%;\r\n   transform: translateX(-50%);\r\n   display: flex;\r\n   flex-direction: row;\r\n   align-items: center;\r\n   justify-content: center;\r\n   margin-top: 10px;\r\n}\r\n\r\n#year-slider {\r\n   width: 50%;\r\n}\r\n\r\n/* div[ref=\"chart\"] {\r\n  margin-bottom: 50px;\r\n} */\r\n</style>\r\n"],"mappings":";AA2CA,SAASA,GAAG,EAAEC,QAAO,QAAS,KAAK;AACnC,OAAO,KAAKC,EAAC,MAAO,IAAI;AACxB,OAAOC,KAAI,MAAO,OAAO;AAEzB,MAAMC,kBAAiB,GAAIJ,GAAG,CAAC,UAAU,CAAC;AAE1C,eAAe;EACZK,IAAIA,CAAA,EAAG;IACJ,OAAO;MACJC,cAAc,EAAEN,GAAG,CAAC,EAAE,CAAC;MACvBO,WAAW,EAAE;MACb;IACH;EACH,CAAC;;EACDC,OAAOA,CAAA,EAAG;IACP,MAAMC,GAAE,GAAIP,EAAE,CAACQ,MAAM,CAAC,IAAI,CAACC,KAAK,CAACC,KAAK,EAClCC,MAAM,CAAC,KAAK,EACZC,IAAI,CAAC,OAAO,EAAE,KAAK,EACnBA,IAAI,CAAC,QAAQ,EAAE,MAAM,EACrBC,KAAK,CAAC,UAAU,EAAE,OAAO,EACzBA,KAAK,CAAC,MAAM,EAAE,KAAK,EACnBA,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC;;IAEvB;IACAb,EAAE,CAACc,GAAG,CAACC,OAAO,CAAC,oBAAoB,CAAC,EAChCC,IAAI,CAACb,IAAG,IAAK;MAEX;MACA,IAAI,CAACc,cAAc,EAAE;MAErB,MAAMC,YAAW,GAAIC,QAAQ,CAACC,UAAU,CAACjB,IAAI,CAACkB,eAAe,EAAE,IAAI,CAAC;MACpEd,GAAG,CAACe,IAAI,EAAE,CAACC,WAAW,CAACL,YAAY,CAAC;;MAEpC;MACA,MAAMM,KAAI,GAAIjB,GAAG,CAACkB,SAAS,CAAC,MAAM,CAAC;;MAEnC;MACAD,KAAI,CACAE,EAAE,CAAC,OAAO,EAAE,IAAI,CAACC,kBAAkB,EACnCD,EAAE,CAAC,WAAW,EAAE,IAAI,CAACE,kBAAkB,EACvCF,EAAE,CAAC,UAAU,EAAE,IAAI,CAACG,mBAAmB,CAAC;;MAE5C;MACA,MAAMC,IAAG,GAAI9B,EAAE,CAAC8B,IAAI,EAAC,CACjBC,WAAW,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;MAAA,CACpBL,EAAE,CAAC,MAAM,EAAE,IAAI,CAACM,MAAM,CAAC,EAAE;;MAE7BzB,GAAG,CAAC0B,IAAI,CAACH,IAAI,CAAC,EAAE;;MAEhB;MACA,IAAI,CAACzB,WAAU,GAAI,CAAC;IAGvB,CAAC,EACA6B,KAAK,CAACC,KAAI,IAAK;MACbC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;IACvB,CAAC,CAAC;IACL,MAAME,SAAQ,GAAI,IAAI,CAACC,MAAM,CAACC,KAAK,CAACF,SAAS;IAC7C,IAAIA,SAAS,EAAE;MACZ,MAAMG,WAAU,GAAIH,SAAS,CAACI,KAAK,CAAC,GAAG,CAAC;MACxC,MAAMC,iBAAgB,GAAIF,WAAW,CAACG,IAAI,CAAC,IAAI,CAAC;IACnD;;IAEA;IACA,MAAMC,UAAS,GAAIzB,QAAQ,CAAC0B,cAAc,CAAC,aAAa,CAAC;IACzDD,UAAU,CAACE,gBAAgB,CAAC,OAAO,EAAGC,KAAK,IAAK;MAC7C,IAAI,CAACC,SAAS,CAACD,KAAK,CAACE,MAAM,CAACC,KAAK,CAAC;IACrC,CAAC,CAAC;EACL,CAAC;EACDC,OAAO,EAAE;IACN;IACAxB,kBAAkBA,CAACoB,KAAK,EAAE;MACvB,MAAMK,IAAG,GAAIL,KAAK,CAACM,aAAa;MAChC,MAAMC,KAAI,GAAI,IAAI,CAACC,YAAW,KAAMH,IAAG,GAAI,IAAI,CAACI,MAAM,CAAC,CAAC,IAAI,IAAI,CAACA,MAAM,CAAC,CAAC,CAAC;MAC1EJ,IAAI,CAACvC,KAAK,CAAC4C,IAAG,GAAIH,KAAK;MACvB,IAAI,CAACC,YAAW,GAAIH,IAAI;IAC3B;IAGA;IACAxB,kBAAkBA,CAACmB,KAAK,EAAE;MACvB,MAAMK,IAAG,GAAIL,KAAK,CAACE,MAAM;MACzB,IAAI,CAACG,IAAI,CAACM,SAAS,CAACC,QAAQ,CAAC,cAAc,CAAC,EAAE;QAC3C;QACAP,IAAI,CAACvC,KAAK,CAAC4C,IAAG,GAAI,MAAM;QACxBtC,QAAQ,CAAC0B,cAAc,CAAC,cAAc,CAAC,CAACe,WAAU,GAAIR,IAAI,CAACS,YAAY,CAAC,OAAO,CAAC;MACnF;IACH,CAAC;IAED;IACAhC,mBAAmBA,CAACkB,KAAK,EAAE;MACxB,MAAMK,IAAG,GAAIL,KAAK,CAACE,MAAM;MAEzB,IAAI,CAACG,IAAI,CAACM,SAAS,CAACC,QAAQ,CAAC,cAAc,CAAC,EAAE;QAC3C;QACA,IAAI,CAACH,MAAM,EAAE;MAChB;IACH,CAAC;IACD;IACAM,cAAcA,CAAA,EAAG;MACd;MACA,IAAI,CAAC1D,cAAc,CAAC2D,MAAM,CAAC,CAAC,CAAC;;MAE7B;MACA,MAAMC,aAAY,GAAI7C,QAAQ,CAAC8C,gBAAgB,CAAC,eAAe,CAAC;MAChED,aAAa,CAACE,OAAO,CAACC,OAAM,IAAK;QAC9BA,OAAO,CAACT,SAAS,CAACU,MAAM,CAAC,cAAc,CAAC;QACxC;QACA,IAAI,CAACZ,MAAM,EAAE;MAChB,CAAC,CAAC;IACL,CAAC;IACD;IACAa,MAAMA,CAAA,EAAG;MACN,IAAI,CAAChE,WAAU,GAAIiE,IAAI,CAACC,GAAG,CAAC,IAAI,CAAClE,WAAU,GAAI,GAAG,EAAE,GAAG,CAAC,EAAE;MAC1DL,EAAE,CAACQ,MAAM,CAAC,KAAK,EAAE;MAAA,CACbgE,UAAU,EAAC,CAAE;MAAA,CACbC,QAAQ,CAAC,GAAG,EAAE;MAAA,CACd7D,IAAI,CAAC,WAAW,EAAE,QAAO,GAAI,IAAI,CAACP,WAAU,GAAI,GAAG,CAAC,EAAE;IAC7D,CAAC;;IACD;IACAqE,OAAOA,CAAA,EAAG;MACP,IAAI,CAACrE,WAAU,GAAIiE,IAAI,CAACK,GAAG,CAAC,IAAI,CAACtE,WAAU,GAAI,GAAG,EAAE,GAAG,CAAC,EAAE;MAC1DL,EAAE,CAACQ,MAAM,CAAC,KAAK,EAAE;MAAA,CACbgE,UAAU,EAAC,CAAE;MAAA,CACbC,QAAQ,CAAC,GAAG,EAAE;MAAA,CACd7D,IAAI,CAAC,WAAW,EAAE,QAAO,GAAI,IAAI,CAACP,WAAU,GAAI,GAAG,CAAC,EAAE;IAE7D,CAAC;;IACD;IACA2B,MAAMA,CAACe,KAAK,EAAE;MACX,IAAI,CAAC1C,WAAU,GAAI0C,KAAK,CAAC6B,SAAS,CAACC,CAAC;MACpC7E,EAAE,CAACQ,MAAM,CAAC,KAAK,CAAC,CAACI,IAAI,CAAC,WAAW,EAAEmC,KAAK,CAAC6B,SAAS,CAAC,EAAE;IACxD,CAAC;;IACDE,gBAAgBA,CAAA,EAAG;MAChB,MAAMpC,iBAAgB,GAAI,IAAI,CAACtC,cAAc,CAAC2E,GAAG,CAACC,KAAI,IAAKA,KAAK,CAACC,KAAK,CAAC,CAACtC,IAAI,CAAC,GAAG,CAAC;MACjF,IAAI,CAACuC,OAAO,CAACC,IAAI,CAAC;QAAEC,IAAI,EAAE,QAAQ;QAAE7C,KAAK,EAAE;UAAEF,SAAS,EAAEK;QAAkB;MAAE,CAAC,CAAC;IACjF,CAAC;IACDzB,cAAcA,CAAA,EAAG;MACd,MAAMoE,MAAK,GAAK,uCAAsCnF,kBAAkB,CAACgD,KAAM,EAAC;MAEhFjD,KAAK,CAACqF,GAAG,CAACD,MAAM,EACZrE,IAAI,CAACuE,QAAO,IAAK;QACf,MAAMpF,IAAG,GAAIoF,QAAQ,CAACpF,IAAI;QAC1B,IAAI,CAACqF,eAAe,CAACrF,IAAI,CAAC;MAC7B,CAAC,EACA+B,KAAK,CAACC,KAAI,IAAK;QACbC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACvB,CAAC,CAAC;IACR,CAAC;IAEDqD,eAAeA,CAACrF,IAAI,EAAE;MACnB,MAAMqB,KAAI,GAAIL,QAAQ,CAAC8C,gBAAgB,CAAC,MAAM,CAAC;MAC/C,MAAMwB,OAAM,GAAItE,QAAQ,CAACuE,aAAa,CAAC,KAAK,CAAC,EAAE;MAC/CD,OAAO,CAAC5E,KAAK,CAAC8E,QAAO,GAAI,UAAU;MACnCF,OAAO,CAAC5E,KAAK,CAAC+E,eAAc,GAAI,OAAO;MACvCH,OAAO,CAAC5E,KAAK,CAACgF,MAAK,GAAI,gBAAgB;MACvCJ,OAAO,CAAC5E,KAAK,CAACiF,OAAM,GAAI,KAAK;MAC7BL,OAAO,CAAC5E,KAAK,CAACkF,aAAY,GAAI,MAAM;MACpCN,OAAO,CAAC5E,KAAK,CAACmF,OAAM,GAAI,MAAM,EAAE;MAChC7E,QAAQ,CAAC8E,IAAI,CAAC1E,WAAW,CAACkE,OAAO,CAAC,EAAE;;MAEpCjE,KAAK,CAAC0C,OAAO,CAACd,IAAG,IAAK;QACnB,MAAM8C,IAAG,GAAI9C,IAAI,CAACS,YAAY,CAAC,IAAI,CAAC;QACpC,MAAMX,KAAI,GAAI/C,IAAI,CAACgG,IAAI,CAACC,IAAG,IAAKA,IAAI,CAACF,IAAG,KAAMA,IAAI,CAAC,EAAEG,MAAK,IAAK,CAAC;QAChEjD,IAAI,CAACkD,YAAY,CAAC,QAAQ,EAAEpD,KAAK,CAAC;QAElCE,IAAI,CAACN,gBAAgB,CAAC,WAAW,EAAE,MAAM;UACtC;UACA,MAAMyD,CAAA,GAAIxD,KAAK,CAACyD,OAAO;UACvB,MAAMC,CAAA,GAAI1D,KAAK,CAAC2D,OAAO;UACvBjB,OAAO,CAAC5E,KAAK,CAAC8F,GAAE,GAAK,GAAEF,CAAE,IAAG;UAC5BhB,OAAO,CAAC5E,KAAK,CAAC+F,IAAG,GAAK,GAAEL,CAAE,IAAG;UAC7Bd,OAAO,CAAC5E,KAAK,CAACmF,OAAM,GAAI,OAAO,EAAE;UACjCP,OAAO,CAAC7B,WAAU,GAAK,GAAER,IAAI,CAACS,YAAY,CAAC,OAAO,CAAE,KAAIX,KAAM,EAAC;QAElE,CAAC,CAAC;QAEFE,IAAI,CAACN,gBAAgB,CAAC,WAAW,EAAE,MAAM;UACtC;UACA,MAAMyD,CAAA,GAAIxD,KAAK,CAACyD,OAAO;UACvB,MAAMC,CAAA,GAAI1D,KAAK,CAAC2D,OAAO;UACvBjB,OAAO,CAAC5E,KAAK,CAAC8F,GAAE,GAAK,GAAEF,CAAE,IAAG;UAC5BhB,OAAO,CAAC5E,KAAK,CAAC+F,IAAG,GAAK,GAAEL,CAAE,IAAG;QAChC,CAAC,CAAC;QAEFnD,IAAI,CAACN,gBAAgB,CAAC,UAAU,EAAE,MAAM;UACrC;UACA2C,OAAO,CAAC5E,KAAK,CAACmF,OAAM,GAAI,MAAM;QACjC,CAAC,CAAC;MACL,CAAC,CAAC;MACF,IAAI,CAACa,eAAe,EAAE;IACzB,CAAC;IACDC,YAAYA,CAACC,UAAU,EAAEvD,MAAM,EAAE;MAC9B;MACA,MAAMwD,cAAa,GAAI7F,QAAQ,CAAC0B,cAAc,CAAC,kBAAkB,CAAC;MAClE,IAAImE,cAAc,EAAE;QACjBA,cAAc,CAAC5C,MAAM,EAAE;MAC1B;MAEA,MAAM6C,eAAc,GAAI9F,QAAQ,CAACuE,aAAa,CAAC,KAAK,CAAC;MACrDuB,eAAe,CAACX,YAAY,CAAC,IAAI,EAAE,kBAAkB,CAAC;MACtDW,eAAe,CAACpG,KAAK,CAACmF,OAAM,GAAI,MAAM;MACtCiB,eAAe,CAACpG,KAAK,CAACqG,aAAY,GAAI,KAAK;MAC3CD,eAAe,CAACpG,KAAK,CAACsG,UAAS,GAAI,QAAQ;MAC3CF,eAAe,CAACpG,KAAK,CAACuG,cAAa,GAAI,QAAQ;MAC/CH,eAAe,CAACpG,KAAK,CAACwG,SAAQ,GAAI,MAAM;MAExC7D,MAAM,CAACU,OAAO,CAAC,CAACZ,KAAK,EAAEgE,KAAK,KAAK;QAC9B,MAAMC,QAAO,GAAIpG,QAAQ,CAACuE,aAAa,CAAC,KAAK,CAAC;QAC9C6B,QAAQ,CAAC1G,KAAK,CAAC+E,eAAc,GAAItC,KAAK;QACtCiE,QAAQ,CAAC1G,KAAK,CAAC2G,KAAI,GAAI,MAAM;QAC7BD,QAAQ,CAAC1G,KAAK,CAAC4G,MAAK,GAAI,MAAM;QAC9BF,QAAQ,CAAC1G,KAAK,CAAC6G,MAAK,GAAI,OAAO;QAE/B,MAAMC,SAAQ,GAAIxG,QAAQ,CAACuE,aAAa,CAAC,MAAM,CAAC;QAChDiC,SAAS,CAAC9G,KAAK,CAAC+G,UAAS,GAAI,KAAK;QAClCD,SAAS,CAAC9G,KAAK,CAACgH,WAAU,GAAI,MAAM;QACpC,MAAMC,KAAI,GAAIf,UAAU,CAACgB,YAAY,CAACzE,KAAK,CAAC;QAC5C;QACA,IAAIgE,KAAI,KAAM,CAAC,EAAE;UACdK,SAAS,CAAC/D,WAAU,GAAK,GAAEkE,KAAK,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC,CAAC,MAAMF,KAAK,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC,CAAE,EAAC;QAC5E,OAAO;UACJL,SAAS,CAAC/D,WAAU,GAAK,GAAEkE,KAAK,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC,CAAC,MAAMF,KAAK,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC,CAAE,EAAC;QAC5E;QAEA,MAAMC,UAAS,GAAI9G,QAAQ,CAACuE,aAAa,CAAC,KAAK,CAAC;QAChDuC,UAAU,CAACpH,KAAK,CAACmF,OAAM,GAAI,MAAM;QACjCiC,UAAU,CAACpH,KAAK,CAACsG,UAAS,GAAI,QAAQ;QACtCc,UAAU,CAAC1G,WAAW,CAACgG,QAAQ,CAAC;QAChCU,UAAU,CAAC1G,WAAW,CAACoG,SAAS,CAAC;QAEjCV,eAAe,CAAC1F,WAAW,CAAC0G,UAAU,CAAC;MAC1C,CAAC,CAAC;;MAEF;MACA9G,QAAQ,CAAC8E,IAAI,CAAC1E,WAAW,CAAC0F,eAAe,CAAC;IAC7C,CAAC;IACDJ,eAAeA,CAAA,EAAG;MACf,MAAMrF,KAAI,GAAIL,QAAQ,CAAC8C,gBAAgB,CAAC,MAAM,CAAC;MAC/C,MAAMT,MAAK,GAAI,CACZ,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAQ,CAEV;MACD,MAAM0E,OAAM,GAAIC,KAAK,CAACC,IAAI,CAAC5G,KAAK,EAAE4B,IAAG,IAAKiF,MAAM,CAACjF,IAAI,CAACS,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC;MAC9E,MAAMyE,SAAQ,GAAIhE,IAAI,CAACK,GAAG,CAAC,GAAGuD,OAAO,CAAC;MACtC,MAAMnB,UAAS,GAAI/G,EAAE,CAACuI,aAAa,EAAC,CAChCC,MAAM,CAACN,OAAO,CAACO,MAAM,CAACpC,MAAK,IAAKA,MAAK,GAAI,CAAC,CAAC,EAAE;MAAA,CAC7CyB,KAAK,CAACtE,MAAM,CAACkF,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE;;MAE5BlH,KAAK,CAAC0C,OAAO,CAACd,IAAG,IAAK;QACnB,MAAMiD,MAAK,GAAIgC,MAAM,CAACjF,IAAI,CAACS,YAAY,CAAC,QAAQ,CAAC,CAAC;QAClD,MAAMP,KAAI,GAAI+C,MAAK,KAAM,IAAI7C,MAAM,CAAC,CAAC,IAAIuD,UAAU,CAACV,MAAM,CAAC,EAAE;QAC7DjD,IAAI,CAACvC,KAAK,CAAC4C,IAAG,GAAIH,KAAK;MAC1B,CAAC,CAAC;;MAEF;MACA,IAAI,CAACwD,YAAY,CAACC,UAAU,EAAEvD,MAAM,CAAC;IACxC,CAAC;IAEDmF,oBAAoBA,CAAC5F,KAAK,EAAE;MACzB7C,kBAAkB,CAACgD,KAAI,GAAIH,KAAK,CAACE,MAAM,CAACC,KAAK;MAC7C,IAAI,CAACjC,cAAc,EAAE;IACxB,CAAC;IAED2H,SAASA,CAAA,EAAG;MACT;MACA,MAAM5B,cAAa,GAAI7F,QAAQ,CAAC0B,cAAc,CAAC,YAAY,CAAC;MAC5D,IAAImE,cAAc,EAAE;QACjBA,cAAc,CAAC5C,MAAM,EAAE;MAC1B;;MAEA;MACA,MAAMyE,MAAK,GAAIC,CAAC,CAACC,OAAO,CAAC;QAAEpD,QAAQ,EAAE;MAAc,CAAC,CAAC;MAErDkD,MAAM,CAACG,KAAI,GAAI,MAAM;QAClB,MAAMC,GAAE,GAAIH,CAAC,CAACI,OAAO,CAACC,MAAM,CAAC,KAAK,EAAE,aAAa,CAAC;QAClDF,GAAG,CAACG,EAAC,GAAI,YAAY,EAAE;QACvB,MAAMC,MAAK,GAAI,IAAI,CAACC,YAAY;QAChC,MAAMC,MAAK,GAAI,EAAE;QAEjB,KAAK,IAAIC,CAAA,GAAI,CAAC,EAAEA,CAAA,GAAIH,MAAM,CAACI,MAAM,EAAED,CAAC,EAAE,EAAE;UACrCD,MAAM,CAACpE,IAAI,CACR,uBAAsB,GACtB,IAAI,CAACuE,QAAQ,CAACL,MAAM,CAACG,CAAC,IAAI,CAAC,IAC3B,SAAQ,GACRH,MAAM,CAACG,CAAC,KACPH,MAAM,CAACG,CAAA,GAAI,CAAC,IAAI,SAAQ,GAAIH,MAAM,CAACG,CAAA,GAAI,CAAC,IAAI,MAAK,GAAI,GAAG,EAC3D;QACJ;QAEAP,GAAG,CAACU,SAAQ,GAAIJ,MAAM,CAAC5G,IAAI,CAAC,EAAE,CAAC;QAC/B,OAAOsG,GAAG;MACb,CAAC;MAEDJ,MAAM,CAACe,KAAK,CAAC,IAAI,CAAC7E,GAAG,CAAC;IACzB,CAAC;IACD/B,SAASA,CAAC6G,IAAI,EAAE;MACb;MACAzH,OAAO,CAAC0H,GAAG,CAAC,mBAAmB,EAAED,IAAI,CAAC;MACtC;IACH,CAAC;;IACDE,SAASA,CAAA,EAAG;MACT,MAAMC,SAAQ,GAAI,IAAI;MACtB,MAAMC,OAAM,GAAI,IAAI;MACpB,IAAIC,WAAU,GAAIF,SAAS;MAE3B,MAAMG,QAAO,GAAIC,WAAW,CAAC,MAAM;QAChCpH,SAAS,CAACkH,WAAW,CAAC;QACtBtH,UAAU,CAACM,KAAI,GAAIgH,WAAW;QAC9BA,WAAW,EAAE;QAEb,IAAIA,WAAU,GAAID,OAAO,EAAE;UACxBI,aAAa,CAACF,QAAQ,CAAC;QAC1B;MACH,CAAC,EAAE,IAAI,CAAC,EAAE;IACb,CAAC;;IACD3G,MAAMA,CAAA,EAAG;MACN,MAAMhC,KAAI,GAAIL,QAAQ,CAAC8C,gBAAgB,CAAC,MAAM,CAAC;MAC/C,MAAMT,MAAK,GAAI,CACZ,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAS,EACT,SAAQ,CAEV;MACD,MAAM0E,OAAM,GAAIC,KAAK,CAACC,IAAI,CAAC5G,KAAK,EAAE4B,IAAG,IAAKiF,MAAM,CAACjF,IAAI,CAACS,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC;MAC9E,MAAMkD,UAAS,GAAI/G,EAAE,CAACuI,aAAa,EAAC,CAChCC,MAAM,CAACN,OAAO,CAACO,MAAM,CAACpC,MAAK,IAAKA,MAAK,GAAI,CAAC,CAAC,EAAE;MAAA,CAC7CyB,KAAK,CAACtE,MAAM,CAACkF,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE;;MAE5BlH,KAAK,CAAC0C,OAAO,CAACd,IAAG,IAAK;QACnB,MAAMiD,MAAK,GAAIgC,MAAM,CAACjF,IAAI,CAACS,YAAY,CAAC,QAAQ,CAAC,CAAC;QAClD,MAAMP,KAAI,GAAI+C,MAAK,KAAM,IAAI7C,MAAM,CAAC,CAAC,IAAIuD,UAAU,CAACV,MAAM,CAAC,EAAE;QAC7DjD,IAAI,CAACvC,KAAK,CAAC4C,IAAG,GAAIH,KAAK;MAC1B,CAAC,CAAC;IACL;;IAEA;IACA;EAIH;AACH,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}